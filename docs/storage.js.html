<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: storage.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: storage.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/*! core/storage.js */

var StorageBase = '../storage';

var Storages = {
  yaml: require('../storage/yaml'),
  memory: require('../storage/memory')
};

/**
 * @class StorageMixin
 * @mixin
 */

exports.exporter = function() {
  this.read = read;
  this.write = write;
  this.remove = remove;
  this.exists = exists;
  this.keys = keys;
  this.storage = storage;
};

/** reads an item
 * @method StorageMixin.prototype.read
 * @param {String} id - item ID
 * @param {Function} callback - function(err, item) {}
 * @returns collection instance itself for method chaining
 */

function read(id, callback) {
  this.storage().read(id, callback);
  return this;
}

/** writes an item
 * @method StorageMixin.prototype.write
 * @param {String} id - item ID
 * @param {Object} item - item content
 * @param {Function} callback - function(err) {}
 * @returns collection instance itself for method chaining
 */

function write(id, item, callback) {
  this.storage().write(id, item, callback);
  return this;
}

/** removes an item
 * @method StorageMixin.prototype.remove
 * @param {String} id - item ID
 * @param {Function} callback - function(err) {}
 * @returns collection instance itself for method chaining
 */

function remove(id, callback) {
  this.storage().remove(id, callback);
  return this;
}

/** tests an item existance
 * @method StorageMixin.prototype.exists
 * @param {String} id - item ID
 * @param {Function} callback - function(err, exist) {}
 * @returns collection instance itself for method chaining
 */

function exists(id, callback) {
  this.storage().exists(id, callback);
  return this;
}

/** lists a list of all item IDs
 * @method StorageMixin.prototype.remove
 * @param {String} id - item ID
 * @param {Function} callback - function(err, list) {}
 * @returns collection instance itself for method chaining
 */

function keys(callback) {
  this.storage().keys(callback);
  return this;
}

/** gets or sets a storage engine
 * @method StorageMixin.prototype.storage
 * @param {Function|String} [store] - storage class or storage name
 * @returns storage instance
 */

function storage(store) {
  // remove store instance cache
  if (store) {
    this._store = null;
  }
  if (!this._store) {
    store = store || this.get('storage');
    if (!store) {
      throw new Error('storage not specified');
    }
    if ('function' != typeof store) {
      store += '';
      if (store.search(/^[\w\-\.]+$/) &lt; 0) {
        throw new Error('invalid store name: ' + store);
      } else {
        var path = StorageBase + '/' + store;
        try {
          store = require(path);
        } catch (e) {
          throw new Error('storage class invalid: ' + store);
        }
        if (!store) {
          throw new Error('storage class invalid: ' + store);
        }
      }
    }
    // cache the last store instance
    this._store = new store(this.options);
  }
  return this._store;
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Cursor.html">Cursor</a></li><li><a href="KagoDB.html">KagoDB</a></li></ul><h3>Mixins</h3><ul><li><a href="CursorMixin.html">CursorMixin</a></li><li><a href="StorageMixin.html">StorageMixin</a></li><li><a href="WebapiMixin.html">WebapiMixin</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.0-dev</a> on Fri May 31 2013 00:04:50 GMT+0900 (JST)
</footer>

<script> prettyPrint(); </script>
</body>
</html>
